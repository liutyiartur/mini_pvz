<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Mini Plants vs Zombies</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #e6f3e6;
            display: flex;
            justify-content: center;
        }

        #game {
            margin-top: 20px;
        }

        canvas {
            background: #b7e3a1;
            border: 3px solid #2f6f2f;
        }

        .info {
            margin-top: 8px;
            text-align: center;
        }

        button {
            padding: 8px 12px;
            margin: 4px;
        }
    </style>
</head>
<body>
<div id="game">
    <canvas id="c" width="600" height="300"></canvas>
    <div class="info">
        <button onclick="addPlant()">ðŸŒ± Plant (cost 50)</button>
        <span id="sun">Sun: 100</span>
        <div>Click a lane to place a plant. Plants shoot automatically.</div>
    </div>
</div>

<script>
    const canvas = document.getElementById('c');
    const ctx = canvas.getContext('2d');
    const lanes = 3;
    const laneH = canvas.height / lanes;
    let sun = 100;
    let plants = [];
    let zombies = [];
    let bullets = [];
    let tick = 0;

    function addPlant() {
        placing = true;
    }

    let placing = false;
    canvas.addEventListener('click', e => {
        if (!placing || sun < 50) return;
        const rect = canvas.getBoundingClientRect();
        const y = e.clientY - rect.top;
        const lane = Math.floor(y / laneH);
        plants.push({x: 100, lane, hp: 5, cd: 0});
        sun -= 50;
        placing = false;
    });

    function spawnZombie() {
        const lane = Math.floor(Math.random() * lanes);
        zombies.push({x: canvas.width - 20, lane, hp: 8});
    }

    function update() {
        tick++;
        if (tick % 120 === 0) spawnZombie();

        plants.forEach(p => {
            p.cd--;
            if (p.cd <= 0) {
                bullets.push({x: p.x + 20, lane: p.lane});
                p.cd = 40;
            }
        });

        bullets.forEach(b => b.x += 4);
        zombies.forEach(z => z.x -= 0.6);

        bullets.forEach((b, bi) => {
            zombies.forEach((z, zi) => {
                if (z.lane === b.lane && Math.abs(z.x - b.x) < 10) {
                    z.hp--;
                    bullets.splice(bi, 1);
                }
            });
        });

        zombies.forEach((z, zi) => {
            if (z.hp <= 0) {
                zombies.splice(zi, 1);
                sun += 25;
            }
            if (z.x < 80) {
                alert('Ð—Ð¾Ð¼Ð±Ð¸ Ð¿Ñ€Ð¾Ñ€Ð²Ð°Ð»Ð¸ÑÑŒ! Ð˜Ð³Ñ€Ð° Ð¾ÐºÐ¾Ð½Ñ‡ÐµÐ½Ð°');
                location.reload();
            }
        });
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let i = 1; i < lanes; i++) {
            ctx.strokeStyle = '#6fbf6f';
            ctx.beginPath();
            ctx.moveTo(0, i * laneH);
            ctx.lineTo(canvas.width, i * laneH);
            ctx.stroke();
        }
        plants.forEach(p => {
            ctx.fillStyle = 'green';
            ctx.fillRect(p.x - 10, p.lane * laneH + laneH / 2 - 10, 20, 20);
        });
        zombies.forEach(z => {
            ctx.fillStyle = 'gray';
            ctx.fillRect(z.x - 10, z.lane * laneH + laneH / 2 - 12, 24, 24);
        });
        bullets.forEach(b => {
            ctx.fillStyle = 'yellow';
            ctx.fillRect(b.x, b.lane * laneH + laneH / 2 - 2, 6, 4);
        });
        document.getElementById('sun').innerText = 'Sun: ' + sun;
    }

    function loop() {
        update();
        draw();
        requestAnimationFrame(loop);
    }

    loop();
</script>
</body>
</html>
